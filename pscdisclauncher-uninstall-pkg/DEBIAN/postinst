#!/bin/sh
set -e

safe_rm() {
  if [ -e "$1" ]; then
    rm -f "$1" || true
  fi
  return 0
}

safe_rmdir() {
  if [ -d "$1" ]; then
    rmdir "$1" 2>/dev/null || true
  fi
  return 0
}

# remove transfer files
safe_rm /media/transfer/disc_launcher.bin
safe_rm /media/transfer/disc_launcher.cue

# remove our injected transfer helper config
safe_rm /media/project_eris/opt/psc_transfer_tools/Game.ini

# remove cover
safe_rm /media/project_eris/opt/psc_transfer_tools/covers/SLUS-99998.png

# remove retroarch configs / cores / modules
safe_rm /media/project_eris/opt/retroarch/config/retroarch/ra-game-cdrom.cfg
safe_rm /media/project_eris/opt/retroarch/config/retroarch/cores/pcsx_rearmed_discproject.so

safe_rm /media/project_eris/opt/retroarch/modules/sr_mod.ko
safe_rm /media/project_eris/opt/retroarch/modules/sg.ko
safe_rm /media/project_eris/opt/retroarch/modules/cdrom.ko

# remove theme assets
safe_rm /media/project_eris/etc/project_eris/THEME/stock/menu_files/ra_disc_launcher_error.png
safe_rm /media/project_eris/etc/project_eris/THEME/stock/menu_files/ra_disc_launcher_invalid_disc.png
safe_rm /media/project_eris/etc/project_eris/THEME/stock/menu_files/ra_disc_launcher_wrong_disc.png

# remove save / opts
safe_rm /media/project_eris/opt/retroarch/config/retroarch/config/PCSX-ReARMed/disc_launcher.opt
safe_rm /media/project_eris/opt/retroarch/saves/disc_launcher.srm
for f in /media/project_eris/opt/retroarch/config/retroarch/config/PCSX-ReARMed/drive[0-9]*.opt; do
  [ -e "$f" ] || continue
  safe_rm "$f"
done
for f in /media/project_eris/opt/retroarch/saves/drive[0-9]*.srm; do
  [ -e "$f" ] || continue
  safe_rm "$f"
done

# remove disc_launcher installed flag
safe_rm /media/project_eris/mods/.installed/disc_launcher

# cleanup empty dirs
safe_rmdir /media/project_eris/opt/retroarch/modules
safe_rmdir /media/project_eris/mods/.uninstall
safe_rmdir /media/project_eris/mods/.installed

exit 0
